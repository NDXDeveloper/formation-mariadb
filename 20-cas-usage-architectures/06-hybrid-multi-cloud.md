ğŸ” Retour au [Sommaire](/SOMMAIRE.md)

# 20.6 Hybrid Cloud et Multi-Cloud

> **Niveau** : AvancÃ©  
> **DurÃ©e estimÃ©e** : 3-4 heures  
> **PrÃ©requis** : Chapitre 16 (DevOps & Automation), Section 20.5 (GÃ©o-distribution), notions d'infrastructure cloud

## ğŸ¯ Objectifs d'apprentissage

Ã€ l'issue de cette section, vous serez capable de :

- Comprendre les motivations et contraintes des architectures hybrid cloud et multi-cloud
- Concevoir des dÃ©ploiements MariaDB rÃ©partis entre on-premise et cloud
- ImplÃ©menter des stratÃ©gies de synchronisation de donnÃ©es cross-environnements
- Utiliser Terraform et Kubernetes pour orchestrer des dÃ©ploiements multi-cloud
- Optimiser les coÃ»ts et la performance dans un contexte distribuÃ©
- Planifier des migrations progressives vers le cloud ou des stratÃ©gies de sortie (exit strategy)

---

## Introduction

Les architectures **hybrid cloud** (combinaison on-premise et cloud) et **multi-cloud** (utilisation de plusieurs fournisseurs cloud) sont devenues des rÃ©alitÃ©s incontournables pour les entreprises. Ces approches permettent d'optimiser les coÃ»ts, d'Ã©viter le vendor lock-in, et de rÃ©pondre Ã  des exigences rÃ©glementaires ou de performance spÃ©cifiques.

MariaDB, en tant que base de donnÃ©es open source, s'intÃ¨gre parfaitement dans ces architectures grÃ¢ce Ã  sa portabilitÃ©, ses mÃ©canismes de rÃ©plication flexibles, et son Ã©cosystÃ¨me d'outils cloud-native comme mariadb-operator.

### Pourquoi Hybrid/Multi-Cloud ?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MOTIVATIONS HYBRID / MULTI-CLOUD                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  HYBRID CLOUD                           MULTI-CLOUD                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•                           â•â•â•â•â•â•â•â•â•â•â•                        â”‚
â”‚                                                                            â”‚
â”‚  On-Premise + Cloud Public              Plusieurs Cloud Providers          â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Datacenter  â”‚â—„â”€â”€â–ºâ”‚    AWS       â”‚  â”‚    AWS       â”‚â—„â–ºâ”‚    GCP       â”‚  â”‚
â”‚  â”‚  On-Premise  â”‚    â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                 â–²               â–²          â”‚
â”‚                                                 â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                         â–¼                  â”‚
â”‚                                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚                                                 â”‚    Azure     â”‚           â”‚
â”‚                                                 â”‚              â”‚           â”‚
â”‚                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                            â”‚
â”‚  MOTIVATIONS COMMUNES :                                                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                    â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. Ã‰VITER LE VENDOR LOCK-IN                                         â”‚   â”‚
â”‚  â”‚    â€¢ NÃ©gociation tarifaire                                          â”‚   â”‚
â”‚  â”‚    â€¢ PortabilitÃ© des workloads                                      â”‚   â”‚
â”‚  â”‚    â€¢ IndÃ©pendance stratÃ©gique                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2. OPTIMISATION DES COÃ›TS                                           â”‚   â”‚
â”‚  â”‚    â€¢ Best-of-breed par service                                      â”‚   â”‚
â”‚  â”‚    â€¢ Spot instances / Preemptible VMs                               â”‚   â”‚
â”‚  â”‚    â€¢ Reserved capacity vs on-demand                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 3. CONFORMITÃ‰ ET SOUVERAINETÃ‰                                       â”‚   â”‚
â”‚  â”‚    â€¢ DonnÃ©es sensibles on-premise                                   â”‚   â”‚
â”‚  â”‚    â€¢ Cloud pour scaling et DR                                       â”‚   â”‚
â”‚  â”‚    â€¢ Exigences rÃ©glementaires par pays                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 4. RÃ‰SILIENCE ET DISPONIBILITÃ‰                                      â”‚   â”‚
â”‚  â”‚    â€¢ DR sur un autre provider                                       â”‚   â”‚
â”‚  â”‚    â€¢ Protection contre pannes rÃ©gionales                            â”‚   â”‚
â”‚  â”‚    â€¢ Diversification des risques                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 5. MIGRATION PROGRESSIVE                                            â”‚   â”‚
â”‚  â”‚    â€¢ Lift-and-shift par Ã©tapes                                      â”‚   â”‚
â”‚  â”‚    â€¢ Tests en parallÃ¨le                                             â”‚   â”‚
â”‚  â”‚    â€¢ Rollback possible                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DÃ©fis spÃ©cifiques

| DÃ©fi | Impact | Solutions MariaDB |
|------|--------|-------------------|
| **Latence rÃ©seau** | Performance cross-cloud | RÃ©plication async, caching |
| **SÃ©curitÃ©** | Trafic inter-cloud exposÃ© | VPN, TLS obligatoire, encryption at rest |
| **CohÃ©rence** | Eventual consistency | GTID, monitoring du lag |
| **CoÃ»ts egress** | Transfert de donnÃ©es coÃ»teux | RÃ©plication optimisÃ©e, compression |
| **ComplexitÃ© ops** | Multiples outils/consoles | IaC unifiÃ© (Terraform), Kubernetes |
| **CompÃ©tences** | Expertise multi-provider | Standardisation sur MariaDB |

---

## Patterns architecturaux

### 1. Hybrid : On-Premise Primary + Cloud DR

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PATTERN 1 : ON-PREMISE PRIMARY + CLOUD DR                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        ON-PREMISE DATACENTER                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚              Galera Cluster (Production)                    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Node 1  â”‚â—„â”€â”€â–ºâ”‚ Node 2  â”‚â—„â”€â”€â–ºâ”‚ Node 3  â”‚                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  (RW)   â”‚    â”‚  (RW)   â”‚    â”‚  (RW)   â”‚                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚       â”‚                                                     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚       â”‚ Sync (Galera)                                       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚       â”‚                                                     â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚          â”‚                                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚   â”‚
â”‚  â”‚  â”‚   MaxScale    â”‚                                                  â”‚   â”‚
â”‚  â”‚  â”‚   (Router)    â”‚                                                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                   â”‚                                        â”‚
â”‚                    VPN / Direct Connect                                    â”‚
â”‚                    Async Replication                                       â”‚
â”‚                                   â”‚                                        â”‚
â”‚                                   â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           AWS / GCP / AZURE                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚              MariaDB Replica (DR / Read Offload)            â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚Replica 1â”‚    â”‚Replica 2â”‚    (Standby - Read-only)        â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  (RO)   â”‚    â”‚  (RO)   â”‚                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                             â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Use cases :                                                        â”‚   â”‚
â”‚  â”‚  â€¢ Disaster Recovery                                                â”‚   â”‚
â”‚  â”‚  â€¢ Read offload pour analytics                                      â”‚   â”‚
â”‚  â”‚  â€¢ Test/Dev environments                                            â”‚   â”‚
â”‚  â”‚  â€¢ Migration progressive                                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  Avantages :                        InconvÃ©nients :                        â”‚
â”‚  âœ… DonnÃ©es sensibles on-prem      âŒ Latence pour DR activation           â”‚
â”‚  âœ… Cloud pour Ã©lasticitÃ©          âŒ CoÃ»ts egress si lecture cloud        â”‚
â”‚  âœ… SimplicitÃ© (1 direction)       âŒ Sous-utilisation ressources cloud    â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Hybrid : Cloud Primary + On-Premise Analytics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PATTERN 2 : CLOUD PRIMARY + ON-PREMISE ANALYTICS              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                              AWS                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚                 Production (InnoDB)                           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Galera  â”‚â—„â”€â”€â–ºâ”‚ Galera  â”‚â—„â”€â”€â–ºâ”‚ Galera  â”‚                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Node 1  â”‚    â”‚ Node 2  â”‚    â”‚ Node 3  â”‚                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                            â”‚                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                            â”‚
â”‚                 RÃ©plication Async (CDC / Debezium)                         â”‚
â”‚                               â”‚                                            â”‚
â”‚                               â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       ON-PREMISE DATACENTER                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚              Data Warehouse (ColumnStore)                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚     UM       â”‚    â”‚     PM1      â”‚    â”‚     PM2      â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚              BI & Analytics Stack                             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Tableau  â”‚  â”‚ Metabase â”‚  â”‚  Jupyter â”‚  â”‚  Airflow â”‚       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  Use cases :                                                               â”‚
â”‚  â€¢ Production cloud pour scaling et disponibilitÃ©                          â”‚
â”‚  â€¢ Analytics on-premise pour compliance (donnÃ©es ne sortent pas)           â”‚
â”‚  â€¢ Utilisation d'infrastructure existante pour compute intensif            â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Multi-Cloud : Active-Active

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PATTERN 3 : MULTI-CLOUD ACTIVE-ACTIVE                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚                         Global Load Balancer                               â”‚
â”‚                      (Cloudflare / Multi-CDN)                              â”‚
â”‚                                â”‚                                           â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚              â”‚                                   â”‚                         â”‚
â”‚              â–¼                                   â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚            AWS                â”‚  â”‚            GCP                 â”‚     â”‚
â”‚  â”‚         (US-EAST-1)           â”‚  â”‚       (europe-west1)           â”‚     â”‚
â”‚  â”‚                               â”‚  â”‚                                â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”‚
â”‚  â”‚  â”‚     EKS Cluster        â”‚   â”‚  â”‚   â”‚     GKE Cluster        â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â”‚  mariadb-operatorâ”‚  â”‚   â”‚  â”‚   â”‚  â”‚  mariadb-operatorâ”‚  â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â”‚                  â”‚  â”‚   â”‚  â”‚   â”‚  â”‚                  â”‚  â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”  â”‚  â”‚   â”‚  â”‚   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”  â”‚  â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Node1â”‚ â”‚Node2â”‚  â”‚  â”‚â—„â”€â”€â”¼â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”¤ â”‚Node1â”‚ â”‚Node2â”‚  â”‚  â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ RW  â”‚ â”‚ RW  â”‚  â”‚  â”‚   â”‚  â”‚   â”‚  â”‚ â”‚ RW  â”‚ â”‚ RW  â”‚  â”‚  â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ Asyncâ”‚   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜  â”‚  â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â”‚                  â”‚  â”‚ Bidirâ”‚   â”‚  â”‚                  â”‚  â”‚   â”‚     â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚
â”‚  â”‚                               â”‚  â”‚                                â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”‚
â”‚  â”‚  â”‚   Applications US      â”‚   â”‚  â”‚   â”‚   Applications EU      â”‚   â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚
â”‚  â”‚                               â”‚  â”‚                                â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                            â”‚
â”‚  Synchronisation :                                                         â”‚
â”‚  â€¢ RÃ©plication async bidirectionnelle                                      â”‚
â”‚  â€¢ Partitionnement par rÃ©gion (Ã©vite conflits)                             â”‚
â”‚  â€¢ Eventual consistency (~1-5 secondes)                                    â”‚
â”‚                                                                            â”‚
â”‚  Avantages :                        InconvÃ©nients :                        â”‚
â”‚  âœ… Pas de vendor lock-in          âŒ ComplexitÃ© opÃ©rationnelle            â”‚
â”‚  âœ… Best-of-breed par rÃ©gion       âŒ CoÃ»ts egress inter-cloud             â”‚
â”‚  âœ… RÃ©silience maximale            âŒ Latence cross-cloud                  â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Cloud Bursting

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PATTERN 4 : CLOUD BURSTING                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚                              Normal Load                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       ON-PREMISE (Baseline)                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚              Galera Cluster (Fixed Capacity)                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Node 1  â”‚    â”‚ Node 2  â”‚    â”‚ Node 3  â”‚                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚                              Peak Load (Black Friday, etc.)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       ON-PREMISE (Baseline)                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚   â”‚
â”‚  â”‚  â”‚ Node 1  â”‚    â”‚ Node 2  â”‚    â”‚ Node 3  â”‚                          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚                                              â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚                  â”‚                     â”‚                                   â”‚
â”‚                  â–¼                     â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚   CLOUD (Burst)       â”‚  â”‚   CLOUD (Burst)       â”‚                      â”‚
â”‚  â”‚   Read Replicas       â”‚  â”‚   Read Replicas       â”‚                      â”‚
â”‚  â”‚   Auto-scaled         â”‚  â”‚   Auto-scaled         â”‚                      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”      â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”      â”‚                      â”‚
â”‚  â”‚  â”‚ R1  â”‚ â”‚ R2  â”‚ ...  â”‚  â”‚  â”‚ R3  â”‚ â”‚ R4  â”‚ ...  â”‚                      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜      â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜      â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                            â”‚
â”‚  MÃ©canisme :                                                               â”‚
â”‚  â€¢ Monitoring de la charge (CPU, connexions, QPS)                          â”‚
â”‚  â€¢ Seuil dÃ©passÃ© â†’ provisionner replicas cloud                             â”‚
â”‚  â€¢ MaxScale route les lectures vers les replicas cloud                     â”‚
â”‚  â€¢ Charge retombe â†’ dÃ©provisionner les replicas                            â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Infrastructure as Code avec Terraform

### Module MariaDB Multi-Cloud

```hcl
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# main.tf - DÃ©ploiement MariaDB Multi-Cloud
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

terraform {
  required_version = ">= 1.5.0"
  
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 5.0"
    }
    google = {
      source  = "hashicorp/google"
      version = "~> 5.0"
    }
    kubernetes = {
      source  = "hashicorp/kubernetes"
      version = "~> 2.23"
    }
  }
  
  backend "s3" {
    bucket = "terraform-state-multicloud"
    key    = "mariadb/terraform.tfstate"
    region = "us-east-1"
  }
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Variables
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

variable "environment" {
  description = "Environment name (prod, staging, dev)"
  type        = string
}

variable "aws_region" {
  description = "AWS region for primary deployment"
  type        = string
  default     = "us-east-1"
}

variable "gcp_region" {
  description = "GCP region for DR deployment"
  type        = string
  default     = "europe-west1"
}

variable "gcp_project" {
  description = "GCP project ID"
  type        = string
}

variable "mariadb_version" {
  description = "MariaDB version"
  type        = string
  default     = "11.8"
}

variable "enable_multi_cloud_dr" {
  description = "Enable GCP DR replica"
  type        = bool
  default     = true
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AWS - Primary Cluster
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

provider "aws" {
  region = var.aws_region
  
  default_tags {
    tags = {
      Environment = var.environment
      ManagedBy   = "terraform"
      Project     = "mariadb-multicloud"
    }
  }
}

# VPC pour MariaDB
module "aws_vpc" {
  source  = "terraform-aws-modules/vpc/aws"
  version = "5.0.0"
  
  name = "mariadb-${var.environment}"
  cidr = "10.0.0.0/16"
  
  azs             = ["${var.aws_region}a", "${var.aws_region}b", "${var.aws_region}c"]
  private_subnets = ["10.0.1.0/24", "10.0.2.0/24", "10.0.3.0/24"]
  public_subnets  = ["10.0.101.0/24", "10.0.102.0/24", "10.0.103.0/24"]
  
  enable_nat_gateway     = true
  single_nat_gateway     = var.environment != "prod"
  enable_dns_hostnames   = true
  enable_dns_support     = true
  
  # VPN Gateway pour connexion on-premise
  enable_vpn_gateway = true
}

# Security Group MariaDB
resource "aws_security_group" "mariadb" {
  name_prefix = "mariadb-${var.environment}-"
  vpc_id      = module.aws_vpc.vpc_id
  
  # MariaDB port
  ingress {
    from_port   = 3306
    to_port     = 3306
    protocol    = "tcp"
    cidr_blocks = [module.aws_vpc.vpc_cidr_block]
  }
  
  # Galera replication
  ingress {
    from_port   = 4567
    to_port     = 4568
    protocol    = "tcp"
    cidr_blocks = [module.aws_vpc.vpc_cidr_block]
  }
  
  # Galera SST
  ingress {
    from_port   = 4444
    to_port     = 4444
    protocol    = "tcp"
    cidr_blocks = [module.aws_vpc.vpc_cidr_block]
  }
  
  # Cross-cloud replication (via VPN)
  ingress {
    from_port   = 3306
    to_port     = 3306
    protocol    = "tcp"
    cidr_blocks = ["10.100.0.0/16"]  # GCP CIDR
    description = "Cross-cloud replication from GCP"
  }
  
  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }
  
  lifecycle {
    create_before_destroy = true
  }
}

# EKS Cluster
module "aws_eks" {
  source  = "terraform-aws-modules/eks/aws"
  version = "19.0.0"
  
  cluster_name    = "mariadb-${var.environment}"
  cluster_version = "1.28"
  
  vpc_id     = module.aws_vpc.vpc_id
  subnet_ids = module.aws_vpc.private_subnets
  
  eks_managed_node_groups = {
    mariadb = {
      name           = "mariadb-nodes"
      instance_types = ["r6g.xlarge"]
      
      min_size     = 3
      max_size     = 6
      desired_size = 3
      
      labels = {
        workload = "mariadb"
      }
      
      taints = [{
        key    = "dedicated"
        value  = "mariadb"
        effect = "NO_SCHEDULE"
      }]
    }
  }
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# GCP - DR Cluster
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

provider "google" {
  project = var.gcp_project
  region  = var.gcp_region
}

# VPC GCP
resource "google_compute_network" "mariadb" {
  count = var.enable_multi_cloud_dr ? 1 : 0
  
  name                    = "mariadb-${var.environment}"
  auto_create_subnetworks = false
}

resource "google_compute_subnetwork" "mariadb" {
  count = var.enable_multi_cloud_dr ? 1 : 0
  
  name          = "mariadb-${var.environment}-subnet"
  ip_cidr_range = "10.100.0.0/24"
  region        = var.gcp_region
  network       = google_compute_network.mariadb[0].id
  
  private_ip_google_access = true
}

# GKE Cluster
resource "google_container_cluster" "mariadb" {
  count = var.enable_multi_cloud_dr ? 1 : 0
  
  name     = "mariadb-${var.environment}"
  location = var.gcp_region
  
  network    = google_compute_network.mariadb[0].name
  subnetwork = google_compute_subnetwork.mariadb[0].name
  
  # Autopilot mode pour simplicitÃ©
  enable_autopilot = true
  
  release_channel {
    channel = "REGULAR"
  }
  
  ip_allocation_policy {
    cluster_ipv4_cidr_block  = "/16"
    services_ipv4_cidr_block = "/22"
  }
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VPN Inter-Cloud (AWS <-> GCP)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# AWS VPN Customer Gateway (pour GCP)
resource "aws_customer_gateway" "gcp" {
  count = var.enable_multi_cloud_dr ? 1 : 0
  
  bgp_asn    = 65000
  ip_address = google_compute_ha_vpn_gateway.aws[0].vpn_interfaces[0].ip_address
  type       = "ipsec.1"
  
  tags = {
    Name = "gcp-vpn-gateway"
  }
}

# GCP HA VPN Gateway
resource "google_compute_ha_vpn_gateway" "aws" {
  count = var.enable_multi_cloud_dr ? 1 : 0
  
  name    = "vpn-to-aws"
  network = google_compute_network.mariadb[0].id
  region  = var.gcp_region
}

# (Configuration VPN complÃ¨te omise pour brevitÃ©)
# Voir documentation AWS/GCP pour les tunnels IPsec

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Outputs
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

output "aws_eks_cluster_endpoint" {
  description = "AWS EKS cluster endpoint"
  value       = module.aws_eks.cluster_endpoint
}

output "gcp_gke_cluster_endpoint" {
  description = "GCP GKE cluster endpoint"
  value       = var.enable_multi_cloud_dr ? google_container_cluster.mariadb[0].endpoint : null
}

output "aws_vpc_id" {
  description = "AWS VPC ID"
  value       = module.aws_vpc.vpc_id
}
```

### DÃ©ploiement MariaDB avec Kubernetes

```yaml
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# mariadb-multicloud.yaml - DÃ©ploiement MariaDB sur Kubernetes multi-cloud
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

---
# Namespace
apiVersion: v1
kind: Namespace
metadata:
  name: mariadb
  labels:
    app.kubernetes.io/name: mariadb
    app.kubernetes.io/part-of: multicloud-db

---
# Secret pour les credentials
apiVersion: v1
kind: Secret
metadata:
  name: mariadb-credentials
  namespace: mariadb
type: Opaque
stringData:
  root-password: "${MARIADB_ROOT_PASSWORD}"
  replication-user: "repl_user"
  replication-password: "${MARIADB_REPL_PASSWORD}"
  app-user: "app_user"
  app-password: "${MARIADB_APP_PASSWORD}"

---
# ConfigMap pour la configuration MariaDB
apiVersion: v1
kind: ConfigMap
metadata:
  name: mariadb-config
  namespace: mariadb
data:
  my.cnf: |
    [mysqld]
    # Identification
    server_id = ${SERVER_ID}
    gtid_domain_id = ${GTID_DOMAIN_ID}
    
    # RÃ©plication
    log_bin = mysql-bin
    binlog_format = ROW
    binlog_row_image = FULL
    log_slave_updates = ON
    gtid_strict_mode = ON
    
    # Performance
    innodb_buffer_pool_size = 8G
    innodb_buffer_pool_instances = 8
    innodb_log_file_size = 2G
    innodb_flush_log_at_trx_commit = 1
    sync_binlog = 1
    
    # RÃ©seau (cross-cloud)
    slave_compressed_protocol = ON
    slave_net_timeout = 120
    
    # TLS obligatoire
    ssl = ON
    ssl_ca = /etc/mysql/ssl/ca.pem
    ssl_cert = /etc/mysql/ssl/server-cert.pem
    ssl_key = /etc/mysql/ssl/server-key.pem
    require_secure_transport = ON

---
# MariaDB Primary (AWS) - via mariadb-operator
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-primary
  namespace: mariadb
  labels:
    app.kubernetes.io/name: mariadb
    topology: primary
    cloud: aws
spec:
  rootPasswordSecretKeyRef:
    name: mariadb-credentials
    key: root-password
  
  image: mariadb:11.8
  imagePullPolicy: IfNotPresent
  
  port: 3306
  
  # Galera pour HA intra-cloud
  galera:
    enabled: true
    replicas: 3
    primary:
      automaticFailover: true
    sst: mariabackup
    replicaThreads: 4
  
  # Stockage
  storage:
    size: 100Gi
    storageClassName: gp3-encrypted
    resizeInUseVolumes: true
  
  # Ressources
  resources:
    requests:
      cpu: "2"
      memory: "8Gi"
    limits:
      cpu: "4"
      memory: "16Gi"
  
  # AffinitÃ© (nodes dÃ©diÃ©s)
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: workload
                operator: In
                values: ["mariadb"]
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchLabels:
              app.kubernetes.io/name: mariadb
          topologyKey: kubernetes.io/hostname
  
  # TolÃ©rations
  tolerations:
    - key: "dedicated"
      operator: "Equal"
      value: "mariadb"
      effect: "NoSchedule"
  
  # MÃ©triques
  metrics:
    enabled: true
    exporter:
      image: prom/mysqld-exporter:v0.15.0
  
  # Configuration personnalisÃ©e
  myCnf: |
    [mysqld]
    server_id = 1
    gtid_domain_id = 1
    log_bin = mysql-bin
    binlog_format = ROW
    log_slave_updates = ON
    
  # Utilisateurs
  users:
    - name: repl_user
      passwordSecretKeyRef:
        name: mariadb-credentials
        key: replication-password
      grants:
        - privileges: ["REPLICATION SLAVE"]
          global: true
    - name: app_user
      passwordSecretKeyRef:
        name: mariadb-credentials
        key: app-password
      grants:
        - database: "*"
          privileges: ["SELECT", "INSERT", "UPDATE", "DELETE"]

---
# Service LoadBalancer pour accÃ¨s cross-cloud
apiVersion: v1
kind: Service
metadata:
  name: mariadb-primary-external
  namespace: mariadb
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-internal: "true"
    service.beta.kubernetes.io/aws-load-balancer-scheme: "internal"
spec:
  type: LoadBalancer
  selector:
    app.kubernetes.io/name: mariadb
    app.kubernetes.io/instance: mariadb-primary
  ports:
    - port: 3306
      targetPort: 3306
      protocol: TCP
```

### Script de rÃ©plication cross-cloud

```bash
#!/bin/bash
# setup-cross-cloud-replication.sh
# Configure la rÃ©plication entre AWS (primary) et GCP (replica)

set -euo pipefail

# Configuration
AWS_PRIMARY_HOST="mariadb-primary.mariadb.svc.cluster.local"
GCP_REPLICA_HOST="mariadb-replica.mariadb.svc.cluster.local"
REPL_USER="repl_user"
REPL_PASSWORD="${MARIADB_REPL_PASSWORD}"

echo "=== Setting up cross-cloud replication ==="

# 1. VÃ©rifier la connectivitÃ©
echo "[1/5] Testing connectivity..."
mysql -h "$AWS_PRIMARY_HOST" -u root -p"$MARIADB_ROOT_PASSWORD" -e "SELECT 1" || {
    echo "ERROR: Cannot connect to AWS primary"
    exit 1
}

mysql -h "$GCP_REPLICA_HOST" -u root -p"$MARIADB_ROOT_PASSWORD" -e "SELECT 1" || {
    echo "ERROR: Cannot connect to GCP replica"
    exit 1
}

# 2. VÃ©rifier que le primary a le binlog activÃ©
echo "[2/5] Checking primary configuration..."
BINLOG_STATUS=$(mysql -h "$AWS_PRIMARY_HOST" -u root -p"$MARIADB_ROOT_PASSWORD" -N -e "SHOW VARIABLES LIKE 'log_bin'" | awk '{print $2}')
if [ "$BINLOG_STATUS" != "ON" ]; then
    echo "ERROR: Binary logging is not enabled on primary"
    exit 1
fi

# 3. RÃ©cupÃ©rer la position GTID
echo "[3/5] Getting GTID position..."
GTID_POS=$(mysql -h "$AWS_PRIMARY_HOST" -u root -p"$MARIADB_ROOT_PASSWORD" -N -e "SELECT @@gtid_current_pos")
echo "Current GTID position: $GTID_POS"

# 4. Configurer le replica
echo "[4/5] Configuring replica..."
mysql -h "$GCP_REPLICA_HOST" -u root -p"$MARIADB_ROOT_PASSWORD" << EOF
-- ArrÃªter toute rÃ©plication existante
STOP SLAVE;
RESET SLAVE ALL;

-- Configurer le GTID
SET GLOBAL gtid_slave_pos = '$GTID_POS';

-- Configurer la connexion au primary
CHANGE MASTER TO
    MASTER_HOST = '$AWS_PRIMARY_HOST',
    MASTER_PORT = 3306,
    MASTER_USER = '$REPL_USER',
    MASTER_PASSWORD = '$REPL_PASSWORD',
    MASTER_USE_GTID = slave_pos,
    MASTER_SSL = 1,
    MASTER_SSL_VERIFY_SERVER_CERT = 1,
    MASTER_CONNECT_RETRY = 60,
    MASTER_RETRY_COUNT = 86400;

-- DÃ©marrer la rÃ©plication
START SLAVE;
EOF

# 5. VÃ©rifier le statut
echo "[5/5] Verifying replication status..."
sleep 5

SLAVE_STATUS=$(mysql -h "$GCP_REPLICA_HOST" -u root -p"$MARIADB_ROOT_PASSWORD" -e "SHOW SLAVE STATUS\G")

IO_RUNNING=$(echo "$SLAVE_STATUS" | grep "Slave_IO_Running:" | awk '{print $2}')
SQL_RUNNING=$(echo "$SLAVE_STATUS" | grep "Slave_SQL_Running:" | awk '{print $2}')
SECONDS_BEHIND=$(echo "$SLAVE_STATUS" | grep "Seconds_Behind_Master:" | awk '{print $2}')

if [ "$IO_RUNNING" == "Yes" ] && [ "$SQL_RUNNING" == "Yes" ]; then
    echo "âœ… Replication is running successfully"
    echo "   Seconds behind master: $SECONDS_BEHIND"
else
    echo "âŒ Replication setup failed"
    echo "$SLAVE_STATUS"
    exit 1
fi

echo "=== Cross-cloud replication setup completed ==="
```

---

## Gestion des coÃ»ts

### Optimisation des coÃ»ts egress

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OPTIMISATION DES COÃ›TS CROSS-CLOUD                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  CoÃ»ts typiques de transfert (egress) :                                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                    â”‚
â”‚                                                                            â”‚
â”‚  AWS â†’ Internet  : $0.09/GB                                                â”‚
â”‚  GCP â†’ Internet  : $0.12/GB                                                â”‚
â”‚  Azure â†’ Internet: $0.087/GB                                               â”‚
â”‚                                                                            â”‚
â”‚  AWS â†’ GCP (via Internet) : $0.09/GB (AWS) + ingress GCP (gratuit)         â”‚
â”‚                                                                            â”‚
â”‚  StratÃ©gies d'optimisation :                                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                              â”‚
â”‚                                                                            â”‚
â”‚  1. COMPRESSION DE LA RÃ‰PLICATION                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [mysqld]                                                           â”‚   â”‚
â”‚  â”‚  slave_compressed_protocol = ON   # Compression zlib                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Gain typique : 50-70% de rÃ©duction du trafic                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  2. FILTRAGE DE LA RÃ‰PLICATION                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  # Ne rÃ©pliquer que les tables essentielles                         â”‚   â”‚
â”‚  â”‚  replicate_do_db = production                                       â”‚   â”‚
â”‚  â”‚  replicate_ignore_table = production.logs                           â”‚   â”‚
â”‚  â”‚  replicate_ignore_table = production.sessions                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  # Ou utiliser le row-based filtering                               â”‚   â”‚
â”‚  â”‚  binlog_row_image = minimal   # Seulement les colonnes modifiÃ©es    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  3. INTERCONNEXION DÃ‰DIÃ‰E                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ AWS Direct Connect + GCP Partner Interconnect                    â”‚   â”‚
â”‚  â”‚  â€¢ CoÃ»t fixe mais rÃ©duit le $/GB                                    â”‚   â”‚
â”‚  â”‚  â€¢ Latence rÃ©duite et bande passante garantie                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Rentable si > 5-10 TB/mois de transfert                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  4. RÃ‰PLICATION DIFFÃ‰RÃ‰E                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  # RÃ©pliquer pendant les heures creuses (tarifs rÃ©duits)            â”‚   â”‚
â”‚  â”‚  # Utiliser des queues pour batch les changements                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Attention : augmente le RPO                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  Exemple de calcul :                                                       â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                       â”‚
â”‚  â€¢ 100 GB binlog/jour â†’ 3 TB/mois                                          â”‚
â”‚  â€¢ Sans compression : 3000 GB Ã— $0.09 = $270/mois                          â”‚
â”‚  â€¢ Avec compression (60%) : 1200 GB Ã— $0.09 = $108/mois                    â”‚
â”‚  â€¢ Ã‰conomie : $162/mois                                                    â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Monitoring des coÃ»ts

```sql
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ESTIMATION DU TRAFIC DE RÃ‰PLICATION
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Taille des binlogs gÃ©nÃ©rÃ©s (proxy pour le trafic de rÃ©plication)
SELECT 
    DATE(FROM_UNIXTIME(UNIX_TIMESTAMP() - (VARIABLE_VALUE))) AS since_startup,
    (SELECT SUM(FILE_SIZE) 
     FROM information_schema.FILES 
     WHERE FILE_TYPE = 'BINARY LOG') / 1024 / 1024 / 1024 AS binlog_size_gb
FROM information_schema.GLOBAL_STATUS
WHERE VARIABLE_NAME = 'Uptime';

-- Estimation du trafic quotidien
SELECT 
    ROUND(
        (SELECT VARIABLE_VALUE FROM information_schema.GLOBAL_STATUS 
         WHERE VARIABLE_NAME = 'Binlog_bytes_written') 
        / 
        (SELECT VARIABLE_VALUE FROM information_schema.GLOBAL_STATUS 
         WHERE VARIABLE_NAME = 'Uptime')
        * 86400 / 1024 / 1024 / 1024
    , 2) AS estimated_daily_binlog_gb;

-- Statistiques de compression (si activÃ©e)
SHOW STATUS LIKE 'Slave_compressed_protocol';
```

---

## SÃ©curitÃ© cross-cloud

### Architecture sÃ©curisÃ©e

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SÃ‰CURITÃ‰ MULTI-CLOUD                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         AWS VPC                                     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Private Subnet                                               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  MariaDB        â”‚    â”‚  Secrets        â”‚                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  (Encrypted     â”‚â—„â”€â”€â”€â”‚  Manager        â”‚                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚   at rest)      â”‚    â”‚  (AWS SM)       â”‚                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚           â”‚                                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚           â”‚ TLS 1.3                                           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚           â”‚                                                   â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚              â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  VPN Gateway (IPsec)                                          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ IKEv2                                                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ AES-256-GCM                                                â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Perfect Forward Secrecy                                    â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚              â”‚                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 â”‚                                                          â”‚
â”‚                 â”‚ IPsec Tunnel (Encrypted)                                 â”‚
â”‚                 â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Cloud VPN Gateway                                            â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚              â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Private Subnet                                               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  MariaDB        â”‚    â”‚  Secret         â”‚                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  Replica        â”‚â—„â”€â”€â”€â”‚  Manager        â”‚                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  (Encrypted)    â”‚    â”‚  (GCP SM)       â”‚                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                         GCP VPC                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                            â”‚
â”‚  Couches de sÃ©curitÃ© :                                                     â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                     â”‚
â”‚  1. RÃ©seau : VPN IPsec, Private subnets, Security Groups/Firewall Rules    â”‚
â”‚  2. Transport : TLS 1.3 obligatoire pour toutes les connexions             â”‚
â”‚  3. Stockage : Encryption at rest (AES-256)                                â”‚
â”‚  4. IdentitÃ© : IAM roles, Service accounts, mTLS                           â”‚
â”‚  5. Secrets : Rotation automatique via Secrets Manager                     â”‚
â”‚  6. Audit : CloudTrail/Cloud Audit Logs, MariaDB Audit Plugin              â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Configuration TLS cross-cloud

```ini
# Configuration MariaDB - TLS obligatoire
[mysqld]
# Certificats (gÃ©nÃ©rÃ©s avec une CA commune cross-cloud)
ssl_ca = /etc/mysql/ssl/cross-cloud-ca.pem
ssl_cert = /etc/mysql/ssl/server-cert.pem
ssl_key = /etc/mysql/ssl/server-key.pem

# Forcer TLS
require_secure_transport = ON

# Version minimale
tls_version = TLSv1.3

# Cipher suites modernes
ssl_cipher = TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256

# VÃ©rification du certificat client pour rÃ©plication
ssl_verify_server_cert = ON
```

```bash
#!/bin/bash
# generate-cross-cloud-certs.sh
# GÃ©nÃ©ration de certificats pour communication cross-cloud

# CrÃ©er la CA commune
openssl genrsa -out cross-cloud-ca-key.pem 4096
openssl req -new -x509 -days 3650 -key cross-cloud-ca-key.pem \
    -out cross-cloud-ca.pem \
    -subj "/CN=MariaDB-Cross-Cloud-CA/O=MyCompany"

# GÃ©nÃ©rer le certificat serveur AWS
openssl genrsa -out aws-server-key.pem 2048
openssl req -new -key aws-server-key.pem -out aws-server.csr \
    -subj "/CN=mariadb-aws.internal/O=MyCompany"
openssl x509 -req -in aws-server.csr -CA cross-cloud-ca.pem \
    -CAkey cross-cloud-ca-key.pem -CAcreateserial \
    -out aws-server-cert.pem -days 365 \
    -extfile <(echo "subjectAltName=DNS:mariadb-aws.internal,DNS:*.mariadb.svc.cluster.local")

# GÃ©nÃ©rer le certificat serveur GCP
openssl genrsa -out gcp-server-key.pem 2048
openssl req -new -key gcp-server-key.pem -out gcp-server.csr \
    -subj "/CN=mariadb-gcp.internal/O=MyCompany"
openssl x509 -req -in gcp-server.csr -CA cross-cloud-ca.pem \
    -CAkey cross-cloud-ca-key.pem -CAcreateserial \
    -out gcp-server-cert.pem -days 365 \
    -extfile <(echo "subjectAltName=DNS:mariadb-gcp.internal,DNS:*.mariadb.svc.cluster.local")

# GÃ©nÃ©rer le certificat client pour rÃ©plication
openssl genrsa -out repl-client-key.pem 2048
openssl req -new -key repl-client-key.pem -out repl-client.csr \
    -subj "/CN=repl_user/O=MyCompany"
openssl x509 -req -in repl-client.csr -CA cross-cloud-ca.pem \
    -CAkey cross-cloud-ca-key.pem -CAcreateserial \
    -out repl-client-cert.pem -days 365

echo "Certificates generated successfully"
```

---

## Migration et exit strategy

### Migration progressive vers le cloud

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MIGRATION PROGRESSIVE VERS LE CLOUD                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Phase 1 : RÃ©plication Read-Only                                            â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                            â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   ON-PREMISE     â”‚    RÃ©plication     â”‚      CLOUD       â”‚               â”‚
â”‚  â”‚   (Primary)      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   (Replica RO)   â”‚               â”‚
â”‚  â”‚   100% trafic    â”‚                    â”‚   Analytics/Test â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                             â”‚
â”‚  Phase 2 : Split Read Traffic                                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                              â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   ON-PREMISE     â”‚                    â”‚      CLOUD       â”‚               â”‚
â”‚  â”‚   (Primary)      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   (Replica)      â”‚               â”‚
â”‚  â”‚   Writes +       â”‚                    â”‚   Read traffic   â”‚               â”‚
â”‚  â”‚   30% Reads      â”‚                    â”‚   70% Reads      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                             â”‚
â”‚  Phase 3 : Switchover                                                       â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                       â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   ON-PREMISE     â”‚                    â”‚      CLOUD       â”‚               â”‚
â”‚  â”‚   (Replica)      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   (Primary)      â”‚               â”‚
â”‚  â”‚   Standby DR     â”‚    RÃ©plication     â”‚   100% trafic    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                             â”‚
â”‚  Phase 4 : DÃ©commissionnement                                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚
â”‚                                                                             â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚                                          â”‚      CLOUD       â”‚               â”‚
â”‚     ON-PREMISE                           â”‚   (Primary)      â”‚               â”‚
â”‚     DÃ©commissionnÃ©                       â”‚   100% trafic    â”‚               â”‚
â”‚                                          â”‚   + Cloud DR     â”‚               â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                             â”‚
â”‚  DurÃ©e typique : 3-6 mois selon la complexitÃ©                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Exit strategy (sortie du cloud)

```bash
#!/bin/bash
# cloud-exit-strategy.sh
# ProcÃ©dure de sortie du cloud vers on-premise ou autre cloud

# Variables
SOURCE_CLOUD="aws"
TARGET_ENV="onprem"  # ou "gcp", "azure"

echo "=== Cloud Exit Strategy Execution ==="
echo "Source: $SOURCE_CLOUD"
echo "Target: $TARGET_ENV"

# 1. Provisionner l'infrastructure cible
echo "[Phase 1] Provisioning target infrastructure..."
case $TARGET_ENV in
    onprem)
        ansible-playbook -i inventory/onprem provision-mariadb.yml
        ;;
    gcp)
        terraform apply -target=module.gcp_mariadb
        ;;
    azure)
        terraform apply -target=module.azure_mariadb
        ;;
esac

# 2. Ã‰tablir la rÃ©plication
echo "[Phase 2] Setting up replication..."
./setup-replication.sh --source=$SOURCE_CLOUD --target=$TARGET_ENV

# 3. Attendre la synchronisation
echo "[Phase 3] Waiting for replication to catch up..."
while true; do
    LAG=$(mysql -h $TARGET_HOST -e "SHOW SLAVE STATUS\G" | grep Seconds_Behind_Master | awk '{print $2}')
    if [ "$LAG" -lt 10 ]; then
        echo "Replication caught up (lag: ${LAG}s)"
        break
    fi
    echo "Current lag: ${LAG}s - waiting..."
    sleep 30
done

# 4. Migration progressive du trafic
echo "[Phase 4] Migrating read traffic..."
./traffic-manager.sh --route-reads $TARGET_ENV --percentage 25
sleep 3600  # Observer pendant 1h
./traffic-manager.sh --route-reads $TARGET_ENV --percentage 50
sleep 3600
./traffic-manager.sh --route-reads $TARGET_ENV --percentage 100

# 5. Switchover des Ã©critures
echo "[Phase 5] Write switchover..."
read -p "Confirm write switchover? (yes/no): " CONFIRM
if [ "$CONFIRM" == "yes" ]; then
    # ArrÃªter les Ã©critures sur la source
    mysql -h $SOURCE_HOST -e "SET GLOBAL read_only = ON"
    
    # Attendre que le replica soit Ã  jour
    sleep 10
    
    # Promouvoir le nouveau primary
    mysql -h $TARGET_HOST -e "STOP SLAVE; RESET SLAVE ALL; SET GLOBAL read_only = OFF"
    
    # Mettre Ã  jour le DNS/routing
    ./traffic-manager.sh --route-writes $TARGET_ENV
    
    echo "Switchover completed!"
fi

# 6. Validation
echo "[Phase 6] Validation..."
./validate-migration.sh --source=$SOURCE_CLOUD --target=$TARGET_ENV

# 7. DÃ©commissionnement (manuel aprÃ¨s pÃ©riode d'observation)
echo "[Phase 7] Schedule decommissioning of $SOURCE_CLOUD resources"
echo "Run 'terraform destroy -target=module.${SOURCE_CLOUD}_mariadb' after 30 days observation"

echo "=== Exit strategy execution completed ==="
```

---

## Ã‰tude de cas : Fintech multi-cloud

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ã‰TUDE DE CAS : FINTECH MULTI-CLOUD                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Contexte :                                                             â”‚
â”‚  â€¢ Plateforme de paiement B2B                                           â”‚
â”‚  â€¢ 10M transactions/jour, pic Ã  500 TPS                                 â”‚
â”‚  â€¢ Exigences PCI-DSS et RGPD                                            â”‚
â”‚  â€¢ RTO < 5 minutes, RPO < 30 secondes                                   â”‚
â”‚  â€¢ Budget : Ã©viter vendor lock-in pour nÃ©gociation                      â”‚
â”‚                                                                         â”‚
â”‚  Architecture retenue :                                                 â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Global Traffic Manager                    â”‚   â”‚
â”‚  â”‚                        (Cloudflare + Failover)                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                  â”‚                                      â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚              â”‚                                       â”‚                  â”‚
â”‚              â–¼                                       â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           AWS                â”‚   â”‚           GCP                 â”‚   â”‚
â”‚  â”‚       (Primary EU)           â”‚   â”‚        (DR + US)              â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚       EKS             â”‚   â”‚   â”‚   â”‚       GKE             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ MariaDB Galera  â”‚  â”‚   â”‚   â”‚   â”‚  â”‚ MariaDB Galera  â”‚  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ (3 nodes)       â”‚  â”‚â—„â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”‚ (3 nodes)       â”‚  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                 â”‚  â”‚ Async â”‚   â”‚  â”‚                 â”‚  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ PCI Zone        â”‚  â”‚ Repl  â”‚   â”‚  â”‚ PCI Zone        â”‚  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                       â”‚   â”‚   â”‚   â”‚                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ MaxScale        â”‚  â”‚   â”‚   â”‚   â”‚  â”‚ MaxScale        â”‚  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ (HA pair)       â”‚  â”‚   â”‚   â”‚   â”‚  â”‚ (HA pair)       â”‚  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚                               â”‚   â”‚
â”‚  â”‚  HSM : AWS CloudHSM          â”‚   â”‚   HSM : Cloud HSM             â”‚   â”‚
â”‚  â”‚  KMS : AWS KMS               â”‚   â”‚   KMS : Cloud KMS             â”‚   â”‚
â”‚  â”‚  Audit : CloudTrail          â”‚   â”‚   Audit : Cloud Audit Logs    â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  DÃ©cisions clÃ©s :                                                       â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                        â”‚
â”‚                                                                         â”‚
â”‚  1. AWS Primary pour EU (RGPD) + GCP DR pour US :                       â”‚
â”‚     â€¢ DonnÃ©es EU restent en EU (Frankfurt)                              â”‚
â”‚     â€¢ DR sur GCP pour Ã©viter single-vendor                              â”‚
â”‚     â€¢ Transactions US routÃ©es vers GCP (latence)                        â”‚
â”‚                                                                         â”‚
â”‚  2. Galera intra-cloud + Async cross-cloud :                            â”‚
â”‚     â€¢ Galera pour consistance forte (paiements critiques)               â”‚
â”‚     â€¢ Async acceptable pour DR (RPO 30s)                                â”‚
â”‚                                                                         â”‚
â”‚  3. VPN dÃ©diÃ© AWS-GCP :                                                 â”‚
â”‚     â€¢ Direct Connect + Partner Interconnect                             â”‚
â”‚     â€¢ Latence rÃ©duite (25ms vs 50ms Internet)                           â”‚
â”‚     â€¢ Trafic prÃ©visible pour compliance                                 â”‚
â”‚                                                                         â”‚
â”‚  4. Encryption partout :                                                â”‚
â”‚     â€¢ TLS 1.3 en transit                                                â”‚
â”‚     â€¢ AES-256 at rest (cloud-native KMS)                                â”‚
â”‚     â€¢ HSM pour clÃ©s de signature                                        â”‚
â”‚                                                                         â”‚
â”‚  MÃ©triques atteintes :                                                  â”‚
â”‚  â€¢ Latence P99 : 45ms (EU), 85ms (US)                                   â”‚
â”‚  â€¢ DisponibilitÃ© : 99.995%                                              â”‚
â”‚  â€¢ RPO cross-cloud : 18 secondes (moyenne)                              â”‚
â”‚  â€¢ RTO failover : 3 minutes                                             â”‚
â”‚  â€¢ Ã‰conomie vendor : 15% nÃ©gociation annuelle                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Points clÃ©s Ã  retenir

- **Hybrid cloud** permet de garder les donnÃ©es sensibles on-premise tout en bÃ©nÃ©ficiant de l'Ã©lasticitÃ© du cloud
- **Multi-cloud** Ã©vite le vendor lock-in mais augmente la complexitÃ© opÃ©rationnelle
- **La latence inter-cloud** (50-150ms) impose la rÃ©plication asynchrone â€” planifiez votre RPO en consÃ©quence
- **Les coÃ»ts egress** peuvent Ãªtre significatifs â€” utilisez la compression et le filtrage de rÃ©plication
- **Terraform + Kubernetes** permettent une orchestration unifiÃ©e des dÃ©ploiements multi-cloud
- **La sÃ©curitÃ© cross-cloud** nÃ©cessite VPN/interconnexion dÃ©diÃ©e, TLS obligatoire, et une PKI commune
- **L'exit strategy** doit Ãªtre planifiÃ©e dÃ¨s le dÃ©part â€” la portabilitÃ© de MariaDB est un atout majeur
- **mariadb-operator** simplifie les dÃ©ploiements Kubernetes multi-cloud

---

## ğŸ”— Ressources et rÃ©fÃ©rences

- [ğŸ“– AWS to GCP VPN Setup](https://cloud.google.com/architecture/build-ha-vpn-connection-google-cloud-aws)
- [ğŸ“– Terraform Multi-Cloud](https://developer.hashicorp.com/terraform/tutorials/multi-cloud)
- [ğŸ“– MariaDB Operator](https://github.com/mariadb-operator/mariadb-operator)
- [ğŸ“– Kubernetes Multi-Cluster](https://kubernetes.io/docs/concepts/cluster-administration/multi-cluster/)
- [ğŸ“– Cloud Egress Costs Comparison](https://cloudcostchecker.com/)
- [ğŸ“– PCI-DSS Cloud Requirements](https://www.pcisecuritystandards.org/document_library)

---


â­ï¸ [Scaling vertical vs horizontal](/20-cas-usage-architectures/07-scaling-vertical-horizontal.md)

üîù Retour au [Sommaire](/SOMMAIRE.md)

# 10.7.3 TLS par d√©faut depuis 11.8 üÜï

> **Niveau** : Avanc√©
> **Dur√©e estim√©e** : 1.5 heures
> **Pr√©requis** : Sections 10.7.1 (Configuration serveur SSL) et 10.7.2 (Certificats et CA)

## üéØ Objectifs d'apprentissage

√Ä l'issue de cette section, vous serez capable de :
- Comprendre les changements majeurs de TLS dans MariaDB 11.8
- Configurer TLS avec les nouveaux comportements par d√©faut
- Migrer depuis des versions ant√©rieures vers 11.8
- G√©rer les exceptions et compatibilit√© avec anciens clients
- Mettre en ≈ìuvre les meilleures pratiques de s√©curit√© TLS en 2025
- Diagnostiquer et r√©soudre les probl√®mes li√©s aux changements TLS

---

## Introduction

**MariaDB 11.8 LTS** (sortie juin 2025) introduit des changements **majeurs et disruptifs** concernant TLS/SSL, marquant une √©volution significative de la politique de s√©curit√© par d√©faut :

### üÜï Changements principaux

1. **TLS activ√© automatiquement** si des certificats SSL sont d√©tect√©s au d√©marrage
2. **require_secure_transport** recommand√© activ√© par d√©faut pour nouvelles installations
3. **TLSv1.3** support√© de mani√®re native et optimis√©e
4. **Protocoles obsol√®tes** (TLSv1.0, TLSv1.1) **d√©sactiv√©s par d√©faut**
5. **Ciphersuites modernes** configur√©es automatiquement

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        √âvolution de la politique TLS de MariaDB             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  MariaDB ‚â§ 10.x - 11.7 :                                    ‚îÇ
‚îÇ  ‚Ä¢ TLS optionnel (ssl=0 par d√©faut)                         ‚îÇ
‚îÇ  ‚Ä¢ Connexions en clair accept√©es                            ‚îÇ
‚îÇ  ‚Ä¢ TLSv1.0/1.1 support√©s                                    ‚îÇ
‚îÇ  ‚Ä¢ require_secure_transport=OFF                             ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  MariaDB 11.8+ : üÜï                                         ‚îÇ
‚îÇ  ‚Ä¢ TLS automatique si certificats pr√©sents                  ‚îÇ
‚îÇ  ‚Ä¢ require_secure_transport=ON recommand√©                   ‚îÇ
‚îÇ  ‚Ä¢ TLSv1.2/1.3 uniquement par d√©faut                        ‚îÇ
‚îÇ  ‚Ä¢ Ciphersuites modernes par d√©faut                         ‚îÇ
‚îÇ  ‚Ä¢ Compatibilit√© pr√©serv√©e via configurations explicites    ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  Impact :                                                   ‚îÇ
‚îÇ  ‚ö†Ô∏è Connexions non-SSL peuvent √™tre refus√©es                ‚îÇ
‚îÇ  ‚úÖ S√©curit√© renforc√©e out-of-the-box                       ‚îÇ
‚îÇ  ‚ö†Ô∏è Migration n√©cessite planification                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üÜï TLS activ√© automatiquement

### Comportement avant MariaDB 11.8

```ini
# MariaDB ‚â§ 11.7 : Configuration manuelle requise
[mysqld]
ssl = 1  # ‚Üê Obligatoire pour activer TLS
ssl_ca   = /etc/mysql/ssl/ca-cert.pem
ssl_cert = /etc/mysql/ssl/server-cert.pem
ssl_key  = /etc/mysql/ssl/server-key.pem

# Sans ssl=1 :
# ‚Üí TLS d√©sactiv√© m√™me si certificats pr√©sents
# ‚Üí Connexions en clair autoris√©es
```

### Comportement depuis MariaDB 11.8 üÜï

```ini
# MariaDB 11.8+ : TLS automatique
[mysqld]
# ssl = 1  ‚Üê PLUS N√âCESSAIRE !

# Si ces fichiers existent et sont valides :
ssl_ca   = /etc/mysql/ssl/ca-cert.pem
ssl_cert = /etc/mysql/ssl/server-cert.pem
ssl_key  = /etc/mysql/ssl/server-key.pem

# ‚Üí TLS activ√© AUTOMATIQUEMENT au d√©marrage
# ‚Üí Connexions SSL et non-SSL accept√©es (sans require_secure_transport)
```

### D√©tection automatique des certificats

```bash
# Au d√©marrage, MariaDB 11.8 :
# 1. Cherche les certificats dans les chemins par d√©faut
# 2. Valide les certificats (permissions, format, validit√©)
# 3. Active TLS si tout est OK

# Chemins par d√©faut recherch√©s :
# - /etc/mysql/ssl/
# - /var/lib/mysql/ (datadir)
# - Chemins configur√©s dans my.cnf

# V√©rifier dans les logs au d√©marrage :
sudo tail -f /var/log/mysql/error.log | grep -i ssl
# [Note] Server socket created with SSL context
# [Note] TLS version: TLSv1.2,TLSv1.3
```

### V√©rifier l'√©tat TLS

```sql
-- V√©rifier que TLS est actif
SHOW VARIABLES LIKE 'have_ssl';
-- +---------------+-------+
-- | Variable_name | Value |
-- +---------------+-------+
-- | have_ssl      | YES   | ‚Üê TLS disponible
-- +---------------+-------+

-- V√©rifier les certificats charg√©s
SHOW VARIABLES LIKE 'ssl%';
-- ssl_ca:   /etc/mysql/ssl/ca-cert.pem
-- ssl_cert: /etc/mysql/ssl/server-cert.pem
-- ssl_key:  /etc/mysql/ssl/server-key.pem

-- V√©rifier les protocoles actifs
SHOW VARIABLES LIKE 'tls_version';
-- tls_version: TLSv1.2,TLSv1.3  ‚Üê TLSv1.0/1.1 d√©sactiv√©s par d√©faut
```

---

## üÜï require_secure_transport par d√©faut

### Nouvelle recommandation de s√©curit√©

```ini
# MariaDB 11.8 : Recommandation officielle
[mysqld]
require_secure_transport = ON  # ‚Üê Nouveau d√©faut recommand√©

# Effet :
# ‚úÖ Connexions SSL obligatoires pour tous (sauf localhost via socket)
# ‚ùå Connexions en clair refus√©es
# ‚ö†Ô∏è Clients sans support SSL ne peuvent pas se connecter
```

### Impact par type de connexion

| Type de connexion | require_secure_transport = OFF | require_secure_transport = ON üÜï |
|-------------------|-------------------------------|----------------------------------|
| **TCP avec SSL** | ‚úÖ Accept√© | ‚úÖ Accept√© |
| **TCP sans SSL** | ‚úÖ Accept√© | ‚ùå **Refus√©** |
| **Socket Unix local** | ‚úÖ Accept√© | ‚úÖ Accept√© (exception) |
| **Named pipe (Windows)** | ‚úÖ Accept√© | ‚úÖ Accept√© (exception) |

üí° **Exception importante** : Les connexions **locales** via socket Unix (`localhost`) ne sont **pas affect√©es** par `require_secure_transport` car elles ne transitent pas par le r√©seau.

### Test de connexion avec require_secure_transport

```bash
# require_secure_transport = ON

# Connexion locale via socket : OK
mysql -u user -p
# Connect√© (via /var/run/mysqld/mysqld.sock)

# Connexion TCP sans SSL : REFUS√âE
mysql -u user -p -h 127.0.0.1 --ssl-mode=DISABLED
# ERROR 3159 (HY000): Connections using insecure transport are prohibited while --require_secure_transport=ON.

# Connexion TCP avec SSL : OK
mysql -u user -p -h mariadb-server.example.com --ssl-mode=REQUIRED
# Connect√© (via SSL/TLS)
```

---

## Comparaison versions : 11.7 vs 11.8

### Tableau comparatif

| Aspect | MariaDB 11.7 | MariaDB 11.8 üÜï | Impact |
|--------|--------------|-----------------|--------|
| **Activation TLS** | Manuelle (`ssl=1`) | Automatique si certificats | Migration simplifi√©e |
| **Protocoles par d√©faut** | TLSv1.0 √† TLSv1.3 | TLSv1.2 et TLSv1.3 | Clients legacy incompatibles |
| **require_secure_transport** | OFF par d√©faut | ON recommand√© | Connexions non-SSL refus√©es |
| **Ciphersuites** | Liste compl√®te | Modernes uniquement | Vieux clients incompatibles |
| **Compatibilit√©** | Maximale | S√©curit√© > Compatibilit√© | Tests requis |

### Comportement par d√©faut au d√©marrage

```sql
-- MariaDB 11.7 (ancienne version)
SHOW VARIABLES LIKE 'ssl';
-- ssl: OFF  ‚Üê TLS d√©sactiv√© par d√©faut

SHOW VARIABLES LIKE 'tls_version';
-- tls_version: TLSv1.0,TLSv1.1,TLSv1.2,TLSv1.3

SHOW VARIABLES LIKE 'require_secure_transport';
-- require_secure_transport: OFF

-- MariaDB 11.8 üÜï (avec certificats pr√©sents)
SHOW VARIABLES LIKE 'have_ssl';
-- have_ssl: YES  ‚Üê TLS automatiquement actif

SHOW VARIABLES LIKE 'tls_version';
-- tls_version: TLSv1.2,TLSv1.3  ‚Üê TLSv1.0/1.1 d√©sactiv√©s

SHOW VARIABLES LIKE 'require_secure_transport';
-- require_secure_transport: OFF  ‚Üê Mais ON recommand√© pour nouvelle install
```

---

## Configuration MariaDB 11.8

### Configuration minimale (d√©veloppement)

```ini
# my.cnf - MariaDB 11.8 - D√©veloppement local
[mysqld]

# Certificats (TLS activ√© automatiquement)
ssl_ca   = /etc/mysql/ssl/ca-cert.pem
ssl_cert = /etc/mysql/ssl/server-cert.pem
ssl_key  = /etc/mysql/ssl/server-key.pem

# Protocoles (d√©faut : TLSv1.2,TLSv1.3)
# tls_version = TLSv1.2,TLSv1.3

# Connexions non-SSL autoris√©es (d√©veloppement)
require_secure_transport = OFF
```

### Configuration production recommand√©e üÜï

```ini
# my.cnf - MariaDB 11.8 - Production
[mysqld]

# === Certificats SSL ===
ssl_ca   = /etc/mysql/ssl/ca-cert.pem
ssl_cert = /etc/mysql/ssl/server-cert.pem
ssl_key  = /etc/mysql/ssl/server-key.pem

# === Protocoles TLS (s√©curit√© maximale) ===
# TLSv1.3 uniquement pour s√©curit√© maximale 2025+
tls_version = TLSv1.3

# Ou TLSv1.2 + TLSv1.3 pour compatibilit√©
# tls_version = TLSv1.2,TLSv1.3

# === Ciphersuites TLS 1.2 (si activ√©) ===
ssl_cipher = ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256

# === Ciphersuites TLS 1.3 ===
tls_ciphersuites = TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256

# üÜï === Forcer TLS pour toutes connexions r√©seau ===
require_secure_transport = ON

# === Session cache (performance) ===
ssl_session_cache_mode = SERVER
ssl_session_cache_timeout = 600

# === D√©sactiver TLS 1.0/1.1 explicitement (d√©j√† par d√©faut) ===
# Aucune configuration n√©cessaire en 11.8
```

### Configuration compatibilit√© (clients legacy)

```ini
# my.cnf - MariaDB 11.8 - Compatibilit√© clients anciens
[mysqld]

ssl_ca   = /etc/mysql/ssl/ca-cert.pem
ssl_cert = /etc/mysql/ssl/server-cert.pem
ssl_key  = /etc/mysql/ssl/server-key.pem

# ‚ö†Ô∏è Activer TLSv1.2 pour clients legacy (Java 7, Python 2.x, etc.)
tls_version = TLSv1.2,TLSv1.3

# ‚ö†Ô∏è Ajouter ciphersuites compatibles (avec prudence)
ssl_cipher = ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-GCM-SHA256

# Connexions non-SSL autoris√©es temporairement
require_secure_transport = OFF

# Documenter la raison et planifier migration
# TODO: Migrer clients vers TLSv1.3 avant Q2 2026
```

---

## Impact sur la migration

### Sc√©nario 1 : Upgrade 11.7 ‚Üí 11.8 avec certificats existants

```bash
# Avant upgrade (MariaDB 11.7)
# my.cnf :
# ssl = 1
# ssl_ca = /etc/mysql/ssl/ca-cert.pem
# ssl_cert = /etc/mysql/ssl/server-cert.pem
# ssl_key = /etc/mysql/ssl/server-key.pem

# Apr√®s upgrade vers 11.8
sudo apt-get update
sudo apt-get install mariadb-server-11.8

# ‚úÖ TLS continue de fonctionner automatiquement
# ‚ö†Ô∏è MAIS : TLSv1.0/1.1 d√©sactiv√©s par d√©faut
# ‚Üí Tester les clients avant migration
```

### Sc√©nario 2 : Upgrade 11.7 ‚Üí 11.8 SANS certificats

```bash
# Avant upgrade (MariaDB 11.7)
# Pas de configuration SSL (connexions en clair)

# Apr√®s upgrade vers 11.8
# ‚Üí Connexions continuent en clair (pas de certificats)
# ‚Üí Pas de changement fonctionnel

# ‚úÖ Recommandation : Profiter de l'upgrade pour activer TLS
# 1. G√©n√©rer des certificats (voir section 10.7.1)
# 2. Red√©marrer MariaDB ‚Üí TLS actif automatiquement
# 3. Configurer require_secure_transport = ON
```

### Sc√©nario 3 : Nouvelle installation 11.8

```bash
# Installation fra√Æche MariaDB 11.8
sudo apt-get install mariadb-server-11.8

# Par d√©faut :
# ‚Ä¢ TLS d√©sactiv√© (pas de certificats g√©n√©r√©s automatiquement)
# ‚Ä¢ require_secure_transport = OFF

# üÜï Recommandation officielle :
# 1. G√©n√©rer des certificats imm√©diatement
# 2. Configurer require_secure_transport = ON
# 3. Red√©marrer ‚Üí S√©curit√© maximale d√®s le d√©part
```

### Checklist de migration

- [ ] **Inventaire clients** : Lister toutes les applications connect√©es
- [ ] **V√©rifier support TLSv1.2/1.3** : Tester chaque client
- [ ] **Identifier clients legacy** : Java < 8, Python < 2.7.9, PHP < 5.6
- [ ] **Tester en staging** : Upgrade sur environnement de test
- [ ] **Configurer exceptions si n√©cessaire** : `tls_version = TLSv1.2,TLSv1.3`
- [ ] **Planifier fen√™tre de maintenance** : Red√©marrage requis
- [ ] **Pr√©parer rollback** : Backup de configuration + downgrade possible
- [ ] **Mettre √† jour documentation** : Nouvelles proc√©dures de connexion
- [ ] **Former les √©quipes** : Changements TLS 11.8
- [ ] **Monitorer post-migration** : Logs d'erreurs SSL, connexions refus√©es

---

## Exceptions et cas particuliers

### 1. D√©sactiver TLS compl√®tement (non recommand√©)

```ini
# my.cnf - D√©sactiver TLS (d√©veloppement local uniquement)
[mysqld]
skip-ssl

# OU
ssl = 0

# ‚ö†Ô∏è √Ä NE PAS UTILISER EN PRODUCTION
```

### 2. Autoriser connexions non-SSL pour certains utilisateurs

```sql
-- Utilisateur avec SSL obligatoire
CREATE USER 'secure_user'@'%'
    IDENTIFIED BY 'password'
    REQUIRE SSL;

-- Utilisateur sans SSL requis (exception)
CREATE USER 'legacy_app'@'10.0.%.%'
    IDENTIFIED BY 'password';
-- Pas de REQUIRE SSL

-- Configuration globale
SET GLOBAL require_secure_transport = ON;

-- R√©sultat :
-- secure_user : Doit utiliser SSL (REQUIRE SSL)
-- legacy_app : Connexion refus√©e (require_secure_transport=ON) ‚ùå

-- Solution : require_secure_transport=OFF
-- OU migrer legacy_app vers SSL
```

üí° **Note** : `require_secure_transport` **√©crase** les contraintes par utilisateur. Si activ√© globalement, TOUS les utilisateurs doivent utiliser SSL (sauf localhost).

### 3. Connexions localhost sans SSL

```bash
# Socket Unix (localhost) : Toujours autoris√©
mysql -u user -p
# Connect√© via /var/run/mysqld/mysqld.sock
# ‚Üí Pas de SSL n√©cessaire (connexion locale s√©curis√©e)

# TCP localhost avec SSL forc√© :
mysql -u user -p -h 127.0.0.1 --ssl-mode=REQUIRED
# ‚Üí SSL requis car connexion TCP (m√™me si localhost)
```

### 4. Applications conteneuris√©es (Docker/Kubernetes)

```yaml
# docker-compose.yml
services:
  mariadb:
    image: mariadb:11.8
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
    volumes:
      - ./ssl:/etc/mysql/ssl
      - ./my.cnf:/etc/mysql/my.cnf
    ports:
      - "3306:3306"

  app:
    image: myapp:latest
    environment:
      DB_HOST: mariadb
      DB_SSL_MODE: REQUIRED  # ‚Üê Activer SSL dans l'app
      DB_SSL_CA: /etc/ssl/ca-cert.pem
    volumes:
      - ./ssl/ca-cert.pem:/etc/ssl/ca-cert.pem:ro
```

---

## Bonnes pratiques MariaDB 11.8

### 1. Activer TLS d√®s l'installation

```bash
#!/bin/bash
# setup-mariadb-11.8-tls.sh
# Configuration TLS automatique apr√®s installation

# 1. G√©n√©rer des certificats
cd /etc/mysql/ssl

# Auto-sign√©s (d√©veloppement)
openssl req -x509 -nodes -days 3650 -newkey rsa:4096 \
    -keyout server-key.pem -out server-cert.pem \
    -subj "/C=FR/ST=IDF/L=Paris/O=MyCompany/CN=$(hostname)"

cp server-cert.pem ca-cert.pem

# Permissions
chown mysql:mysql *.pem
chmod 400 server-key.pem
chmod 444 server-cert.pem ca-cert.pem

# 2. Configurer my.cnf
cat >> /etc/mysql/my.cnf <<EOF

# TLS Configuration (MariaDB 11.8)
[mysqld]
ssl_ca   = /etc/mysql/ssl/ca-cert.pem
ssl_cert = /etc/mysql/ssl/server-cert.pem
ssl_key  = /etc/mysql/ssl/server-key.pem
tls_version = TLSv1.3
require_secure_transport = ON
EOF

# 3. Red√©marrer
systemctl restart mariadb

# 4. V√©rifier
mysql -u root -p -e "SHOW VARIABLES LIKE 'have_ssl';"
# have_ssl: YES ‚úÖ
```

### 2. Audit r√©gulier des protocoles TLS

```sql
-- V√©rifier les protocoles actifs
SELECT @@tls_version;
-- TLSv1.2,TLSv1.3

-- V√©rifier les connexions actives et leurs protocoles
-- Note : N√©cessite instrumentation
SELECT
    SUBSTRING_INDEX(host, ':', 1) AS client_ip,
    user,
    command,
    time
FROM information_schema.processlist
WHERE host NOT LIKE 'localhost%';

-- Statistiques SSL
SHOW STATUS LIKE 'Ssl%';
-- Ssl_version: TLSv1.3 (connexions r√©centes)
```

### 3. Monitoring des connexions refus√©es

```bash
# Surveiller les connexions refus√©es pour SSL
sudo tail -f /var/log/mysql/error.log | grep -i "insecure transport"

# Alert si connexions non-SSL tent√©es
# 2025-12-13 10:00:00 [Warning] Aborted connection 123 to db: 'mydb' user: 'app_user' host: '192.168.1.50' (Connections using insecure transport are prohibited)
```

### 4. Documentation des exceptions

```sql
-- Cr√©er une table d'audit des exceptions TLS
CREATE TABLE security_audit.tls_exceptions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user VARCHAR(100),
    host VARCHAR(100),
    reason TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expiration_date DATE,
    approved_by VARCHAR(100)
);

-- Documenter chaque exception
INSERT INTO security_audit.tls_exceptions
(user, host, reason, expiration_date, approved_by)
VALUES
('legacy_app', '10.0.%.%',
 'Application legacy Java 7 - Migration pr√©vue Q2 2026',
 '2026-06-30',
 'security_team');
```

---

## D√©pannage

### Probl√®me 1 : "Insecure transport prohibited"

```bash
# Sympt√¥me
mysql -u user -p -h mariadb-server.example.com
# ERROR 3159 (HY000): Connections using insecure transport are prohibited while --require_secure_transport=ON.

# Cause : require_secure_transport = ON et client sans SSL

# Solution 1 : Forcer SSL c√¥t√© client
mysql -u user -p -h mariadb-server.example.com --ssl-mode=REQUIRED

# Solution 2 : D√©sactiver require_secure_transport (temporaire)
# my.cnf
# require_secure_transport = OFF
# systemctl restart mariadb
```

### Probl√®me 2 : "SSL version/cipher mismatch"

```bash
# Sympt√¥me
mysql -u user -p -h server
# ERROR 2026 (HY000): SSL connection error: error:1425F102:SSL routines:ssl_choose_client_version:unsupported protocol

# Cause : Client supporte uniquement TLSv1.0/1.1 (d√©sactiv√©s en 11.8)

# Diagnostic : V√©rifier version client
mysql --version
# mysql  Ver 15.1 Distrib 5.5.68-MariaDB  ‚Üê Ancien client

# Solution 1 : Mettre √† jour le client
sudo apt-get install mariadb-client-11.8

# Solution 2 : Activer TLSv1.2 sur le serveur (temporaire)
```

```ini
# my.cnf
[mysqld]
tls_version = TLSv1.2,TLSv1.3  # Ajouter TLSv1.2
```

### Probl√®me 3 : TLS non activ√© malgr√© certificats

```sql
-- V√©rifier l'√©tat TLS
SHOW VARIABLES LIKE 'have_ssl';
-- have_ssl: DISABLED

-- Cause possible : Erreur dans les certificats

-- V√©rifier les logs
```

```bash
sudo tail -f /var/log/mysql/error.log | grep -i ssl
# [ERROR] SSL error: Unable to get certificate
# [ERROR] Failed to setup SSL

# Causes courantes :
# 1. Permissions incorrectes (server-key.pem pas en 400)
# 2. Certificat expir√©
# 3. Chemin incorrect dans my.cnf
# 4. Certificat non sign√© par CA configur√©e

# V√©rifier permissions
ls -l /etc/mysql/ssl/
# -r-------- 1 mysql mysql server-key.pem  ‚Üê Doit √™tre 400
```

---

## ‚úÖ Points cl√©s √† retenir

- üÜï **MariaDB 11.8** : TLS activ√© **automatiquement** si certificats pr√©sents au d√©marrage
- üÜï **require_secure_transport = ON** recommand√© par d√©faut (nouvelles installations)
- üÜï **TLSv1.0 et TLSv1.1** d√©sactiv√©s par d√©faut (s√©curit√© 2025)
- üÜï **TLSv1.3** support√© nativement et optimis√©
- **Migration** : Tester les clients avant upgrade (compatibilit√© TLSv1.2/1.3)
- **Exceptions** : Localhost via socket Unix toujours autoris√© sans SSL
- **Configuration** : `ssl=1` n'est plus n√©cessaire en 11.8
- **Production** : `tls_version = TLSv1.3` + `require_secure_transport = ON` recommand√©
- **Compatibilit√©** : `tls_version = TLSv1.2,TLSv1.3` pour clients legacy temporairement
- **Monitoring** : Surveiller les connexions refus√©es et les erreurs SSL post-migration

---

## üîó Ressources et r√©f√©rences

- [üìñ MariaDB 11.8 Release Notes - TLS Changes](https://mariadb.com/kb/en/mariadb-1180-release-notes/)
- [üìñ require_secure_transport Documentation](https://mariadb.com/kb/en/server-system-variables/#require_secure_transport)
- [üìñ TLS Protocol Versions](https://mariadb.com/kb/en/ssltls-system-variables/#tls_version)
- [üìñ Migration Guide to 11.8](https://mariadb.com/kb/en/upgrading-to-mariadb-118/)
- [Blog : What's New in MariaDB 11.8 LTS - Security](https://mariadb.org/mariadb-11-8-security-enhancements/)

---

## ‚û°Ô∏è Section suivante

**10.8 [Audit et logging](/10-securite-gestion-utilisateurs/08-audit-logging.md)** : D√©couvrez le Server Audit Plugin, la journalisation des connexions et requ√™tes, et les meilleures pratiques pour la conformit√© et la tra√ßabilit√©.

‚è≠Ô∏è [Audit et logging](/10-securite-gestion-utilisateurs/08-audit-logging.md)
